<!DOCTYPE html><html lang="en" class="scroll-smooth" data-astro-transition-scope="astro-smooz4hq-1"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.png"><link rel="canonical" href="https://vtsakalos.com/posts/kafka-py-go/"><meta name="generator" content="Astro v4.4.0"><!-- General Meta Tags --><title>Vasileios Tsakalos | Build a kafka application in Python and Go</title><meta name="title" content="Vasileios Tsakalos | Build a kafka application in Python and Go"><meta name="description" content="Explore Kafka's fundamentals and implementation nuances, from theoretical underpinnings to hands-on coding examples, learn to leverage Kafka's distributed streaming platform effectively in both Python and Go environments."><meta name="author" content="Vasileios Tsakalos"><link rel="sitemap" href="/sitemap-index.xml"><!-- Open Graph / Facebook --><meta property="og:title" content="Vasileios Tsakalos | Build a kafka application in Python and Go"><meta property="og:description" content="Explore Kafka's fundamentals and implementation nuances, from theoretical underpinnings to hands-on coding examples, learn to leverage Kafka's distributed streaming platform effectively in both Python and Go environments."><meta property="og:url" content="https://vtsakalos.com/posts/kafka-py-go/"><meta property="og:image" content="https://vtsakalos.com/posts/build-a-kafka-application-in-python-and-go.png"><!-- Article Published/Modified time --><meta property="article:published_time" content="2023-04-25T18:59:32.283Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://vtsakalos.com/posts/kafka-py-go/"><meta property="twitter:title" content="Vasileios Tsakalos | Build a kafka application in Python and Go"><meta property="twitter:description" content="Explore Kafka's fundamentals and implementation nuances, from theoretical underpinnings to hands-on coding examples, learn to leverage Kafka's distributed streaming platform effectively in both Python and Go environments."><meta property="twitter:image" content="https://vtsakalos.com/posts/build-a-kafka-application-in-python-and-go.png"><!-- Google Font --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&display=swap" rel="stylesheet"><meta name="theme-color" content=""><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script src="/toggle-theme.js"></script><link rel="stylesheet" href="/_astro/index.CiARLz32.css" />
<style>.pagination-wrapper:where(.astro-d776pwuy){margin-bottom:1rem;margin-top:auto;display:flex;-webkit-user-select:none;-moz-user-select:none;user-select:none;justify-content:center}.disabled:where(.astro-d776pwuy){pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;opacity:.5}.disabled:where(.astro-d776pwuy):hover{--tw-text-opacity: 1;color:rgba(var(--color-text-base),var(--tw-text-opacity))}.group:where(.astro-d776pwuy):hover .disabled:where(.astro-d776pwuy){fill:rgb(var(--color-text-base))}.group:where(.astro-d776pwuy):hover .disabled-svg:where(.astro-d776pwuy){fill:rgb(var(--color-text-base))!important}
a:where(.astro-blwjyjpt){position:relative;text-decoration-line:underline;text-decoration-style:dashed}a:where(.astro-blwjyjpt):hover{top:-.125rem;--tw-text-opacity: 1;color:rgba(var(--color-accent),var(--tw-text-opacity))}a:where(.astro-blwjyjpt):focus-visible{padding:.25rem}a:where(.astro-blwjyjpt) svg:where(.astro-blwjyjpt){margin-right:-1.25rem;height:1.5rem;width:1.5rem;--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-text-opacity: 1;color:rgba(var(--color-text-base),var(--tw-text-opacity));opacity:.8}.group:where(.astro-blwjyjpt):hover a:where(.astro-blwjyjpt) svg:where(.astro-blwjyjpt){fill:rgb(var(--color-accent))}
main:where(.astro-rynkmgph){margin-left:auto;margin-right:auto;width:100%;max-width:64rem;padding-left:1rem;padding-right:1rem;padding-bottom:3rem}.post-title:where(.astro-rynkmgph){font-size:1.5rem;line-height:2rem;font-weight:600;--tw-text-opacity: 1;color:rgba(var(--color-accent),var(--tw-text-opacity))}
</style><script type="module" src="/_astro/hoisted.B2MTPbHz.js"></script><style>[data-astro-transition-scope="astro-smooz4hq-1"] { view-transition-name: astro-smooz4hq-1; }@layer astro { ::view-transition-old(astro-smooz4hq-1) { animation: none; opacity: 0; mix-blend-mode: normal; }::view-transition-new(astro-smooz4hq-1) { animation: none; mix-blend-mode: normal; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-1"] { animation: none; mix-blend-mode: normal; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-1"] { animation: none; mix-blend-mode: normal; }</style></head> <body>  <header class="astro-3ef6ksr2"> <a id="skip-to-content" href="#main-content" class="astro-3ef6ksr2">Skip to content</a> <div class="nav-container astro-3ef6ksr2"> <div class="top-nav-wrap astro-3ef6ksr2"> <a href="/" class="logo whitespace-nowrap astro-3ef6ksr2"> Vasileios Tsakalos </a> <nav id="nav-menu" class="astro-3ef6ksr2"> <button class="hamburger-menu focus-outline astro-3ef6ksr2" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="menu-icon astro-3ef6ksr2"> <line x1="7" y1="12" x2="21" y2="12" class="line astro-3ef6ksr2"></line> <line x1="3" y1="6" x2="21" y2="6" class="line astro-3ef6ksr2"></line> <line x1="12" y1="18" x2="21" y2="18" class="line astro-3ef6ksr2"></line> <line x1="18" y1="6" x2="6" y2="18" class="close astro-3ef6ksr2"></line> <line x1="6" y1="6" x2="18" y2="18" class="close astro-3ef6ksr2"></line> </svg> </button> <ul id="menu-items" class="display-none sm:flex astro-3ef6ksr2"> <li class="astro-3ef6ksr2"> <a href="/posts/" class="active astro-3ef6ksr2">
Posts
</a> </li> <li class="astro-3ef6ksr2"> <a href="/tags/" class=" astro-3ef6ksr2">
Tags
</a> </li> <li class="astro-3ef6ksr2"> <a href="/projects/" class=" astro-3ef6ksr2">
Projects
</a> </li> <li class="astro-3ef6ksr2"> <a href="/services/" class=" astro-3ef6ksr2">
Services
</a> </li> <li class="astro-3ef6ksr2"> <a href="/about/" class=" astro-3ef6ksr2">
About
</a> </li> <li class="astro-3ef6ksr2"> <a href="/search/" class="group hover:text-skin-accent focus-outline p-3 sm:p-1  flex astro-3ef6ksr2" aria-label="Search" title="Search" target="_self"> <svg xmlns="http://www.w3.org/2000/svg" class="scale-125 sm:scale-100 astro-3ef6ksr2"><path d="M19.023 16.977a35.13 35.13 0 0 1-1.367-1.384c-.372-.378-.596-.653-.596-.653l-2.8-1.337A6.962 6.962 0 0 0 16 9c0-3.859-3.14-7-7-7S2 5.141 2 9s3.14 7 7 7c1.763 0 3.37-.66 4.603-1.739l1.337 2.8s.275.224.653.596c.387.363.896.854 1.384 1.367l1.358 1.392.604.646 2.121-2.121-.646-.604c-.379-.372-.885-.866-1.391-1.36zM9 14c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z" class="astro-3ef6ksr2"></path> </svg> <span class="sr-only astro-3ef6ksr2">Search</span> </a> </li> <li class="astro-3ef6ksr2"> <button id="theme-btn" class="focus-outline astro-3ef6ksr2" title="Toggles light & dark" aria-label="auto" aria-live="polite"> <svg xmlns="http://www.w3.org/2000/svg" id="moon-svg" class="astro-3ef6ksr2"> <path d="M20.742 13.045a8.088 8.088 0 0 1-2.077.271c-2.135 0-4.14-.83-5.646-2.336a8.025 8.025 0 0 1-2.064-7.723A1 1 0 0 0 9.73 2.034a10.014 10.014 0 0 0-4.489 2.582c-3.898 3.898-3.898 10.243 0 14.143a9.937 9.937 0 0 0 7.072 2.93 9.93 9.93 0 0 0 7.07-2.929 10.007 10.007 0 0 0 2.583-4.491 1.001 1.001 0 0 0-1.224-1.224zm-2.772 4.301a7.947 7.947 0 0 1-5.656 2.343 7.953 7.953 0 0 1-5.658-2.344c-3.118-3.119-3.118-8.195 0-11.314a7.923 7.923 0 0 1 2.06-1.483 10.027 10.027 0 0 0 2.89 7.848 9.972 9.972 0 0 0 7.848 2.891 8.036 8.036 0 0 1-1.484 2.059z" class="astro-3ef6ksr2"></path> </svg> <svg xmlns="http://www.w3.org/2000/svg" id="sun-svg" class="astro-3ef6ksr2"> <path d="M6.993 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007S14.761 6.993 12 6.993 6.993 9.239 6.993 12zM12 8.993c1.658 0 3.007 1.349 3.007 3.007S13.658 15.007 12 15.007 8.993 13.658 8.993 12 10.342 8.993 12 8.993zM10.998 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2h-3zm17 0h3v2h-3zM4.219 18.363l2.12-2.122 1.415 1.414-2.12 2.122zM16.24 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.342 7.759 4.22 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z" class="astro-3ef6ksr2"></path> </svg> </button> </li> </ul> </nav> </div> </div> <div class="mx-auto px-4"> <hr class="border-skin-line" aria-hidden="true"> </div> </header>   <div class="mx-auto flex w-full max-w-5xl justify-start px-2 astro-rynkmgph"> <button class="focus-outline mb-2 mt-8 flex hover:opacity-75 astro-rynkmgph" onclick="(() => (history.length === 1) ? window.location = '/' : history.back())()"> <svg xmlns="http://www.w3.org/2000/svg" class="astro-rynkmgph"><path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" class="astro-rynkmgph"></path> </svg><span class="astro-rynkmgph">Go back</span> </button> </div> <main id="main-content" class="astro-rynkmgph"> <h1 class="post-title astro-rynkmgph">Build a kafka application in Python and Go</h1> <div class="flex items-center space-x-2 opacity-80 my-2 astro-rynkmgph"><svg xmlns="http://www.w3.org/2000/svg" class="scale-100 inline-block h-6 w-6 min-w-[1.375rem] fill-skin-base" aria-hidden="true"><path d="M7 11h2v2H7zm0 4h2v2H7zm4-4h2v2h-2zm0 4h2v2h-2zm4-4h2v2h-2zm0 4h2v2h-2z"></path><path d="M5 22h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2h-2V2h-2v2H9V2H7v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2zM19 8l.001 12H5V8h14z"></path></svg><span class="sr-only">Published:</span><span class="italic text-base"><time dateTime="2023-04-25T18:59:32.283Z">Apr 26, 2023</time><span aria-hidden="true"> | </span><span class="sr-only"> at </span><span class="text-nowrap">02:59 AM</span></span></div> <article id="article" role="article" class="prose max-w-full mt-4 astro-rynkmgph"> <p><a href="https://kafka.apache.org/">Apache Kafka</a>
is an open-source distributed event streaming platform used by <a href="https://kafka.apache.org/powered-by">thousands of companies</a> for high-performance data pipelines, streaming analytics, data integration, and mission-critical applications.</p>
<p>Some of the benefits are:</p>
<ul>
<li>
<p><strong>Scalability</strong>: Kafka is designed to handle large-scale, high-throughput, real-time data processing.</p>
</li>
<li>
<p><strong>Real-time processing</strong>: Kafka enables real-time data processing by providing low latency and high throughput.</p>
</li>
<li>
<p><strong>Reliability</strong>: Kafka is designed to be highly reliable, with features such as replication, partitioning, and fault tolerance.</p>
</li>
</ul>
<p>Some of the real-life use cases for Kafka are <a href="https://www.gartner.com/en/information-technology/glossary/clickstream-analysis#:~:text=A%20form%20of%20Web%20analytics,monitor%20and%20measure%20website%20activity">clickstream analysis</a>, credit card fraud detection, <a href="https://www.oracle.com/internet-of-things/what-is-iot/#:~:text=What%20is%20IoT%3F,and%20systems%20over%20the%20internet">internet of things</a>. Overall, Kafka is a great platform to use if you need to have real-time data processing.</p>
<h1 id="components">Components</h1>
<p>The high level architecture of Kafka is illustrated below. It may look a bit confusing, we will decompose it and hopefully it will be clear after this section.</p>
<p><img  src="/_astro/kafka_architecture.cEzrk7Rk_Zg0rAr.webp" alt="IR systems" width="719" height="410" loading="lazy" decoding="async"></p>
<ul>
<li>
<p><strong>Producer</strong>: a client that sends (publishes/produces) messages or data to Kafka.</p>
</li>
<li>
<p><strong>Consumer</strong>: a client that reads (subscribes/consumes) messages or data from Kafka.</p>
</li>
<li>
<p><strong>Broker</strong>: a server that acts as a message broker. It receives messages from the producer and stores them in the topic partitions (think of a topic like a group of queues for now). It is also responsible for replicating the data across multiple brokers for fault-tolerance and scalability.</p>
<ul>
<li>Note: in order to have multiple brokers, network latency needs to be very low (&#x3C;15ms).</li>
</ul>
</li>
<li>
<p><strong>Topic</strong>: category or stream name to which the producer publishes messages and the consumer subscribes to messages. Each topic is divided into partitions, and each partition can be replicated across multiple brokers for high availability and scalability. Think about it like a folder in a filesystem, and you have many workers (producers and consumers) which read and write data from there.</p>
</li>
<li>
<p><strong>Partition</strong>: unit of parallelism in Kafka that stores a subset of messages in a topic.</p>
</li>
<li>
<p><strong>Consumer group</strong>: A consumer group is a group of consumers that work together to consume messages from a topic. Each consumer in the group subscribes toa unique subset of partitions in the topic, allowing for parallel processing of messages.</p>
</li>
<li>
<p><strong>Zookeeper</strong>: manage and coordinate the brokers and consumers in the cluster. It also provides a centralized infrastructure for maintaining configuration information, naming, synchronization, and group services. In particular it is responsible for the following activities:</p>
<ul>
<li>
<p><strong>cluster coordination</strong>: manage the Kafka cluster, including keeping track of the status of the brokers, topics, and partitions. It makes sure the cluster is in consistent state and provides unified view to the brokers and consumers.</p>
</li>
<li>
<p><strong>Configuration management</strong>: manage the configuration information of the brokers and consumers. When a new broker registers to Zookeeper and it retrieves the configurations again from Zookeeper.</p>
</li>
<li>
<p><strong>Leader election</strong>: if a partition leader (the partition consumer reads the messages from) fails, zookeeper is responsible for finding the new leader.</p>
</li>
<li>
<p><strong>Group membership:</strong> Zookeeper keeps track of which consumers are member of which group. This allows Kafka to balance the load among the consumers and ensure that each message is processed exactly once.</p>
</li>
</ul>
</li>
</ul>
<h1 id="kafka-implementation-on-premise">Kafka implementation (on premise)</h1>
<p>We will go through the steps you need in order to have Kafka up and running into your own server. Before starting, you should have Apache Kafka installed into your machine. In case you don’t, please follow the following walk-throughs for <a href="https://hevodata.com/blog/how-to-install-kafka-on-ubuntu/">ubuntu</a> and <a href="https://www.conduktor.io/kafka/how-to-install-apache-kafka-on-mac-with-homebrew/">mac</a>.</p>
<p>After having Kafka in your machine, you follow the following steps in order to get started:</p>
<ol>
<li>Start Kafka: <code>sudo systemctl start kafka</code></li>
<li>Check Kafka status (it should be active): <code>sudo systemctl status kafka</code></li>
<li>Start Zookeeper: <code>sudo systemctl enable zookeeper</code></li>
<li>Enable Kafka: <code>sudo systemctl enable kafka</code></li>
</ol>
<h2 id="python-implementation">Python implementation</h2>
<h3 id="producer">Producer</h3>
<p>We should create first the producer which will be publishing messages to the topic.</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#C678DD">from</span><span style="color:#ABB2BF"> kafka </span><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> KafkaProducer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic"># Create a Kafka producer instance</span></span>
<span class="line"><span style="color:#ABB2BF">producer </span><span style="color:#56B6C2">=</span><span style="color:#61AFEF"> KafkaProducer</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">    bootstrap_servers</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[</span><span style="color:#98C379">'localhost:9092'</span><span style="color:#ABB2BF">], </span><span style="color:#7F848E;font-style:italic"># list of brokers</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">    value_serializer</span><span style="color:#56B6C2">=</span><span style="color:#C678DD">lambda</span><span style="color:#D19A66;font-style:italic"> x</span><span style="color:#ABB2BF">: x.</span><span style="color:#61AFEF">encode</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'utf-8'</span><span style="color:#ABB2BF">) </span><span style="color:#7F848E;font-style:italic"># Convert data to bytes</span></span>
<span class="line"><span style="color:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic"># Send a message to a topic</span></span>
<span class="line"><span style="color:#ABB2BF">producer.</span><span style="color:#61AFEF">send</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            # topic you will be publishing</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">            topic</span><span style="color:#56B6C2">=</span><span style="color:#98C379">'test-group'</span><span style="color:#ABB2BF">, </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            # you can find the list of partitions </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            # producer.partitions_for('test-topic')</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            # Partition you will be publishing</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">            partition</span><span style="color:#56B6C2">=</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            # must be bytes or serializable to bites</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">            value</span><span style="color:#56B6C2">=</span><span style="color:#98C379">'Hello, Kafka!'</span><span style="color:#ABB2BF"> </span></span>
<span class="line"><span style="color:#ABB2BF">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic"># Make all buffered records available to be published</span></span>
<span class="line"><span style="color:#ABB2BF">producer.</span><span style="color:#61AFEF">flush</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">Consumer</span></span>
<span class="line"><span style="color:#ABB2BF">We will create one consumer which will be subscribing to the topic we publish to </span><span style="color:#C678DD">with</span><span style="color:#ABB2BF"> Producer.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">from</span><span style="color:#ABB2BF"> kafka </span><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> KafkaConsumer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic"># Create a Kafka consumer instance</span></span>
<span class="line"><span style="color:#ABB2BF">consumer </span><span style="color:#56B6C2">=</span><span style="color:#61AFEF"> KafkaConsumer</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#98C379">    'test-topic'</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # list of brokers</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">    bootstrap_servers</span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF">[</span><span style="color:#98C379">'localhost:9092'</span><span style="color:#ABB2BF">],</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # Start from the earliest message in the topic</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">    auto_offset_reset</span><span style="color:#56B6C2">=</span><span style="color:#98C379">'earliest'</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # The id of the group consumer belongs to</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">    group_id</span><span style="color:#56B6C2">=</span><span style="color:#98C379">'test-group'</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # Convert bytes to data</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic">    value_deserializer</span><span style="color:#56B6C2">=</span><span style="color:#C678DD">lambda</span><span style="color:#D19A66;font-style:italic"> x</span><span style="color:#ABB2BF">: x.</span><span style="color:#61AFEF">decode</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'utf-8'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic"># Read messages from the topic</span></span>
<span class="line"><span style="color:#C678DD">for</span><span style="color:#ABB2BF"> message </span><span style="color:#C678DD">in</span><span style="color:#ABB2BF"> consumer:</span></span>
<span class="line"><span style="color:#56B6C2">    print</span><span style="color:#ABB2BF">(message.value)</span></span></code></pre>
<h2 id="go-implementation">Go implementation</h2>
<h3 id="producer-1">Producer</h3>
<p>We should create first the producer which will be publishing messages to the topic.</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#C678DD">package</span><span style="color:#E5C07B"> main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> (</span></span>
<span class="line"><span style="color:#98C379">    "fmt"</span></span>
<span class="line"><span style="color:#98C379">    "log"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379">    "github.com/Shopify/sarama"</span></span>
<span class="line"><span style="color:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">func</span><span style="color:#61AFEF"> main</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#E06C75">    config</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> sarama</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">NewConfig</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#E06C75">    config.Producer.Return.Successes</span><span style="color:#E5C07B"> =</span><span style="color:#D19A66"> true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">    producer</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> sarama</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">NewSyncProducer</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#ABB2BF">        []</span><span style="color:#C678DD">string</span><span style="color:#ABB2BF">{</span><span style="color:#98C379">"localhost:9092"</span><span style="color:#ABB2BF">}, </span><span style="color:#7F848E;font-style:italic">// Arrays of brokers</span></span>
<span class="line"><span style="color:#E06C75">        config</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF">    )</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> err</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> nil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">        log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Fatalf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Failed to start producer: </span><span style="color:#D19A66">%s</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // make sure you close the producer</span></span>
<span class="line"><span style="color:#C678DD">    defer</span><span style="color:#C678DD"> func</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> err</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> producer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Close</span><span style="color:#ABB2BF">(); </span><span style="color:#E06C75">err</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> nil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">            log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Fatalf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Failed to close producer cleanly: </span><span style="color:#D19A66">%s</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">    topic</span><span style="color:#E5C07B"> :=</span><span style="color:#98C379"> "test-group"</span></span>
<span class="line"><span style="color:#E06C75">    msg</span><span style="color:#E5C07B"> :=</span><span style="color:#C678DD"> &#x26;</span><span style="color:#E5C07B">sarama</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">ProducerMessage</span><span style="color:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75">        Topic</span><span style="color:#ABB2BF">: </span><span style="color:#E06C75">topic</span><span style="color:#ABB2BF">,                                 </span><span style="color:#7F848E;font-style:italic">// Topic name</span></span>
<span class="line"><span style="color:#E06C75">        Value</span><span style="color:#ABB2BF">: </span><span style="color:#E06C75">sarama</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">StringEncoder</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Hello, Kafka!"</span><span style="color:#ABB2BF">), </span><span style="color:#7F848E;font-style:italic">// message content</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">    partition</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">offset</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> producer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">SendMessage</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">msg</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> err</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> nil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">        log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Fatalf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Failed to send message to Kafka: </span><span style="color:#D19A66">%s</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">    fmt</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Printf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Message sent to partition </span><span style="color:#D19A66">%d</span><span style="color:#98C379"> at offset </span><span style="color:#D19A66">%d</span><span style="color:#56B6C2">\n</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">        partition</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">        offset</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h3 id="consumer">Consumer</h3>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#C678DD">package</span><span style="color:#E5C07B"> main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#ABB2BF"> (</span></span>
<span class="line"><span style="color:#98C379">    "fmt"</span></span>
<span class="line"><span style="color:#98C379">    "log"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379">    "github.com/Shopify/sarama"</span></span>
<span class="line"><span style="color:#ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">func</span><span style="color:#61AFEF"> main</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#E06C75">    config</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> sarama</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">NewConfig</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#E06C75">    config.Consumer.Return.Errors</span><span style="color:#E5C07B"> =</span><span style="color:#D19A66"> true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">    consumer</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> sarama</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">NewConsumer</span><span style="color:#ABB2BF">([]</span><span style="color:#C678DD">string</span><span style="color:#ABB2BF">{</span><span style="color:#98C379">"localhost:9092"</span><span style="color:#ABB2BF">}, </span><span style="color:#E06C75">config</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> err</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> nil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">        log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Fatalf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Failed to start consumer: </span><span style="color:#D19A66">%s</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // make sure you close the consumer</span></span>
<span class="line"><span style="color:#C678DD">    defer</span><span style="color:#C678DD"> func</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> err</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> consumer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Close</span><span style="color:#ABB2BF">(); </span><span style="color:#E06C75">err</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> nil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">            log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Fatalf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Failed to close consumer cleanly: </span><span style="color:#D19A66">%s</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">    topic</span><span style="color:#E5C07B"> :=</span><span style="color:#98C379"> "test-group"</span></span>
<span class="line"><span style="color:#E06C75">    partition</span><span style="color:#E5C07B"> :=</span><span style="color:#C678DD"> int32</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // Start from the earliest message in the topic</span></span>
<span class="line"><span style="color:#E06C75">    offset</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> sarama</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">OffsetNewest</span><span style="color:#ABB2BF"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">    partitionConsumer</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> consumer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">ConsumePartition</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">topic</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">partition</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">offset</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> err</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> nil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">        log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Fatalf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Failed to start partition consumer: </span><span style="color:#D19A66">%s</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#C678DD">    defer</span><span style="color:#C678DD"> func</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#E06C75"> err</span><span style="color:#E5C07B"> :=</span><span style="color:#E06C75"> partitionConsumer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Close</span><span style="color:#ABB2BF">(); </span><span style="color:#E06C75">err</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> nil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">            log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Fatalf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Failed to close partition consumer cleanly: </span><span style="color:#D19A66">%s</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    for</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        select</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        case</span><span style="color:#E06C75"> msg</span><span style="color:#E5C07B"> :=</span><span style="color:#56B6C2"> &#x3C;-</span><span style="color:#E06C75">partitionConsumer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Messages</span><span style="color:#ABB2BF">():</span></span>
<span class="line"><span style="color:#E06C75">            fmt</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Printf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Received message: </span><span style="color:#D19A66">%s</span><span style="color:#56B6C2">\n</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">msg</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">Value</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#C678DD">        case</span><span style="color:#E06C75"> err</span><span style="color:#E5C07B"> :=</span><span style="color:#56B6C2"> &#x3C;-</span><span style="color:#E06C75">partitionConsumer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Errors</span><span style="color:#ABB2BF">():</span></span>
<span class="line"><span style="color:#E06C75">            log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">Fatalf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Error consuming message: </span><span style="color:#D19A66">%s</span><span style="color:#98C379">"</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre> </article> <ul class="my-8 astro-rynkmgph"> <li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"> <a href="/tags/data-engineering/" class="text-sm pr-2 group astro-blwjyjpt"> <svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path> </svg>
&nbsp;<span class="astro-blwjyjpt">data-engineering</span> </a> </li> <li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"> <a href="/tags/streaming-data/" class="text-sm pr-2 group astro-blwjyjpt"> <svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path> </svg>
&nbsp;<span class="astro-blwjyjpt">streaming-data</span> </a> </li> <li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"> <a href="/tags/kafka/" class="text-sm pr-2 group astro-blwjyjpt"> <svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path> </svg>
&nbsp;<span class="astro-blwjyjpt">kafka</span> </a> </li> <li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"> <a href="/tags/python/" class="text-sm pr-2 group astro-blwjyjpt"> <svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path> </svg>
&nbsp;<span class="astro-blwjyjpt">python</span> </a> </li> <li class="inline-block my-1 underline-offset-4 astro-blwjyjpt"> <a href="/tags/go/" class="text-sm pr-2 group astro-blwjyjpt"> <svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-blwjyjpt"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-blwjyjpt"></path> </svg>
&nbsp;<span class="astro-blwjyjpt">go</span> </a> </li>  </ul> <div class="flex flex-col-reverse items-center justify-between gap-6 sm:flex-row-reverse sm:items-end sm:gap-4 astro-rynkmgph"> <button id="back-to-top" class="focus-outline whitespace-nowrap py-1 hover:opacity-75 astro-rynkmgph"> <svg xmlns="http://www.w3.org/2000/svg" class="rotate-90 astro-rynkmgph"> <path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" class="astro-rynkmgph"></path> </svg> <span class="astro-rynkmgph">Back to Top</span> </button> </div> </main> <footer class="mt-auto astro-sz7xmlte"> <div class="mx-auto px-0"> <hr class="border-skin-line" aria-hidden="true"> </div> <div class="footer-wrapper astro-sz7xmlte"> <div class="social-icons flex astro-upu6fzxr"> <a href="https://buy.stripe.com/28obMAdue2or07udQR" class="group hover:text-skin-accent link-button astro-upu6fzxr" aria-label="Support Vasileios Tsakalos via Stripe (monthly subscription)" title="Support Vasileios Tsakalos via Stripe (monthly subscription)" target="_blank"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M11.453 8.056c0 -.623 .518 -.979 1.442 -.979c1.69 0 3.41 .343 4.605 .923l.5 -4c-.948 -.449 -2.82 -1 -5.5 -1c-1.895 0 -3.373 .087 -4.5 1c-1.172 .956 -2 2.33 -2 4c0 3.03 1.958 4.906 5 6c1.961 .69 3 .743 3 1.5c0 .735 -.851 1.5 -2 1.5c-1.423 0 -3.963 -.609 -5.5 -1.5l-.5 4c1.321 .734 3.474 1.5 6 1.5c2 0 3.957 -.468 5.084 -1.36c1.263 -.979 1.916 -2.268 1.916 -4.14c0 -3.096 -1.915 -4.547 -5 -5.637c-1.646 -.605 -2.544 -1.07 -2.544 -1.807z" /></svg> <span class="sr-only astro-upu6fzxr">Support Vasileios Tsakalos via Stripe (monthly subscription)</span> </a><a href="https://donate.stripe.com/9AQcQE61M6EHcUg9AA" class="group hover:text-skin-accent link-button astro-upu6fzxr" aria-label="Support Vasileios Tsakalos via Stripe (one-time donation)" title="Support Vasileios Tsakalos via Stripe (one-time donation)" target="_blank"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1" /><path d="M12 7v10" /></svg> <span class="sr-only astro-upu6fzxr">Support Vasileios Tsakalos via Stripe (one-time donation)</span> </a><a href="https://paypal.me/gpiskas" class="group hover:text-skin-accent link-button astro-upu6fzxr" aria-label="Support Vasileios Tsakalos via PayPal (one-time donation)" title="Support Vasileios Tsakalos via PayPal (one-time donation)" target="_blank"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 13l2.5 0c2.5 0 5 -2.5 5 -5c0 -3 -1.9 -5 -5 -5h-5.5c-.5 0 -1 .5 -1 1l-2 14c0 .5 .5 1 1 1h2.8l1.2 -5c.1 -.6 .4 -1 1 -1zm7.5 -5.8c1.7 1 2.5 2.8 2.5 4.8c0 2.5 -2.5 4.5 -5 4.5h-2.6l-.6 3.6a1 1 0 0 1 -1 .8l-2.7 0a.5 .5 0 0 1 -.5 -.6l.2 -1.4" /></svg> <span class="sr-only astro-upu6fzxr">Support Vasileios Tsakalos via PayPal (one-time donation)</span> </a><a href="https://ko-fi.com/gpiskas" class="group hover:text-skin-accent link-button astro-upu6fzxr" aria-label="Support Vasileios Tsakalos via Ko-Fi" title="Support Vasileios Tsakalos via Ko-Fi" target="_blank"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 14c.83 .642 2.077 1.017 3.5 1c1.423 .017 2.67 -.358 3.5 -1c.83 -.642 2.077 -1.017 3.5 -1c1.423 -.017 2.67 .358 3.5 1" /><path d="M8 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2" /><path d="M12 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2" /><path d="M3 10h14v5a6 6 0 0 1 -6 6h-2a6 6 0 0 1 -6 -6v-5z" /><path d="M16.746 16.726a3 3 0 1 0 .252 -5.555" /></svg> <span class="sr-only astro-upu6fzxr">Support Vasileios Tsakalos via Ko-Fi</span> </a><a href="https://www.linkedin.com/in/vasileiostsakalos" class="group hover:text-skin-accent link-button astro-upu6fzxr" aria-label="Vasileios Tsakalos on LinkedIn" title="Vasileios Tsakalos on LinkedIn" target="_blank"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z" /><path d="M8 11l0 5" /><path d="M8 8l0 .01" /><path d="M12 16l0 -5" /><path d="M16 16v-3a2 2 0 0 0 -4 0" /></svg> <span class="sr-only astro-upu6fzxr">Vasileios Tsakalos on LinkedIn</span> </a><a href="https://github.com/sponsors/VasTsak" class="group hover:text-skin-accent link-button astro-upu6fzxr" aria-label="Vasileios Tsakalos on GitHub" title="Vasileios Tsakalos on GitHub" target="_blank"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" /></svg> <span class="sr-only astro-upu6fzxr">Vasileios Tsakalos on GitHub</span> </a><a href="mailto:vtsakalos@proton.me" class="group hover:text-skin-accent link-button astro-upu6fzxr" aria-label="Send an email to Vasileios Tsakalos" title="Send an email to Vasileios Tsakalos" target="_blank"> <svg xmlns="http://www.w3.org/2000/svg" class="icon-tabler" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M13 19h-8a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v6" /><path d="M3 7l9 6l9 -6" /><path d="M16 22l5 -5" /><path d="M21 21.5v-4.5h-4.5" /></svg> <span class="sr-only astro-upu6fzxr">Send an email to Vasileios Tsakalos</span> </a> </div>  <div class="copyright-wrapper astro-sz7xmlte"> <span class="astro-sz7xmlte">Vasileios Tsakalos &#169; 2024</span> <span class="separator astro-sz7xmlte">&nbsp;|&nbsp;</span> <span class="highlight astro-sz7xmlte">Imagine anything, can create the impossible.</span> </div> </div> </footer>   </body></html>  <script>
  /** Attaches links to headings in the document,
   *  allowing sharing of sections easily */
  function addHeadingLinks() {
    let headings = Array.from(document.querySelectorAll("h2, h3, h4, h5, h6"));
    for (let heading of headings) {
      heading.classList.add("group");
      let link = document.createElement("a");
      link.innerText = "#";
      link.className = "heading-link hidden group-hover:inline-block ml-2";
      link.href = "#" + heading.id;
      link.ariaHidden = "true";
      heading.appendChild(link);
    }
  }
  addHeadingLinks();

  /** Attaches copy buttons to code blocks in the document,
   * allowing users to copy code easily. */
  function attachCopyButtons() {
    let copyButtonLabel = "Copy";
    let codeBlocks = Array.from(document.querySelectorAll("pre"));

    for (let codeBlock of codeBlocks) {
      let wrapper = document.createElement("div");
      wrapper.style.position = "relative";

      let copyButton = document.createElement("button");
      copyButton.className =
        "copy-code absolute right-3 -top-3 rounded bg-skin-card px-2 py-1 text-xs leading-4 text-skin-base font-medium";
      copyButton.innerHTML = copyButtonLabel;
      codeBlock.setAttribute("tabindex", "0");
      codeBlock.appendChild(copyButton);

      // wrap codebock with relative parent element
      codeBlock?.parentNode?.insertBefore(wrapper, codeBlock);
      wrapper.appendChild(codeBlock);

      copyButton.addEventListener("click", async () => {
        await copyCode(codeBlock, copyButton);
      });
    }

    async function copyCode(block, button) {
      let code = block.querySelector("code");
      let text = code?.innerText;

      await navigator.clipboard.writeText(text ?? "");

      // visual feedback that task is completed
      button.innerText = "Copied";

      setTimeout(() => {
        button.innerText = copyButtonLabel;
      }, 700);
    }
  }
  attachCopyButtons();

  /** Scrolls the document to the top when
   * the "Back to Top" button is clicked. */
  function backToTop() {
    document.querySelector("#back-to-top")?.addEventListener("click", () => {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    });
  }
  backToTop();
</script>